;; mode: tuareg-jbuild-mode

(ocamllex (modules bc_lexer))
(menhir (modules bc_parser))

(library
 (name bc_front_lib)
 (public_name baccaml.front)
 (modules bc_front bc_lexer bc_parser sub)
 (flags (-w -4-33-40-41-42-43-34-44
         -short-paths
         -strict-sequence
         -strict-formats
         -short-paths
         -keep-locs))
 (libraries core)
  (preprocess (pps ppx_deriving.show))
)

(library
 (name        bc_lib)
 (public_name baccaml.lib)
 (libraries logs bacCaml minCaml bc_front_lib)
 (modules bc_lib)
 (flags (-w -4-33-40-41-42-43-34-44
         -short-paths
         -strict-sequence
         -strict-formats
         -short-paths
         -keep-locs))
 (preprocess (pps ppx_fields_conv)))

(executable
 (name        baccaml_cli)
 (public_name baccaml.cli)
 (modules baccaml_cli)
 (libraries bc_front_lib minCaml bacCaml bc_lib core logs fmt stringext)
 (flags (-w -4-33-40-41-42-43-34-44
         -short-paths
         -strict-sequence
         -strict-formats
         -short-paths
         -keep-locs))
 (preprocess (pps ppx_fields_conv ppx_deriving.show)))

(executable
 (name baccaml_builder)
 (public_name baccaml.builder)
 (modules baccaml_builder)
 (libraries minCaml bacCaml core logs fmt stringext)
 (flags (-w -4-33-40-41-42-43-34-44
         -short-paths
         -strict-sequence
         -strict-formats
         -short-paths
         -keep-locs))
 (preprocess (pps ppx_fields_conv ppx_deriving.show)))

(executable
 (name bc_front_test)
 (public_name baccaml.front_test)
 (modules bc_front_test)
 (libraries bc_front_lib bc_lib core logs fmt stringext)
 (flags (-w -4-33-40-41-42-43-34-44
         -short-paths
         -strict-sequence
         -strict-formats
         -short-paths
         -keep-locs))
 (preprocess (pps ppx_fields_conv ppx_deriving.show)))
